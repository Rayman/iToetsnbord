<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
         "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>iPhone Navigation</title>
<meta name="viewport" content="width=320; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;"/>
<style type="text/css" media="screen">@import "iphonenav.css";</style>
<script type="application/x-javascript" src="scripts/mootools-1.2.4-core.js"></script>
<script type="application/x-javascript" src="scripts/iphonenav.js"></script>
<script type="application/x-javascript">

function updateCurrent(responseJSON){
	$('currentAlbum').set('html', "Album: " + responseJSON.album);
	$('currentArtist').set('html', "Artist: " + responseJSON.artist);
	$('currentTitle').set('html', "Title: " + responseJSON.title);
	$('currentInfo').set(
		'html',
		"Info: " + responseJSON.bitrate + "kbps, " + 
		responseJSON.samplerate + "kHz " + 
		responseJSON.channels
	);
	$('currentAlbumArt').setProperty('src', responseJSON.albumart);
}

function loadAsync(requestUrl, processFunction){
	var myRequest = new Request.JSON({
		method: "get",
		url: requestUrl,
		onSuccess: function(responseJSON, responseText){
			processFunction(responseJSON);
		},
		onFailure: function(){
			alert('Error getting current song');
		}
	});
	myRequest.send();
}

function getSearchResults(element){
	var artist = $(lastSubmittedForm).getElement('input[name=artist]').value;
	var song   = $(lastSubmittedForm).getElement('input[name=song]').value;
	artist = artist == '' ? '' : 'ARTIST HAS "' + artist +'"';
	song   = song   == '' ? '' : 'TITLE HAS  "' + song   +'"';
	query = (song != '' && artist != '') ? song + ' && ' + artist : song + artist;
	var myRequest = new Request.JSON({
		method: "get",
		url: 'getsearchresults.html?query='+query,
		onSuccess: function(responseJSON, responseText){
			alert(responseText);
		}
	});
	myRequest.send();	
}

window.addEvent('domready', function() {
	loadAsync('getcurrent.html', updateCurrent);
});
</script>
</head>

<body>
    <h1 id="pageTitle"></h1>
    <a id="homeButton" class="button" href="#home">Home</a>
    <a class="button" href="#searchForm">Search</a>
    
    <ul id="home" title="Home" selected="true">
        <li><a id="getCurrent" href="#current">Current Played File</a></li>
        <li><a href="#test">Enqueue</a></li>
        <li><a href="#options">Options</a></li>
        <li><a href="#player">Jasdfdf</a></li>
    </ul>
    
    <div id="current" class="panel" title="Current">
    	<table width="100%">
			<tr>
				<td>
					<a href="javascript:void(0)" onclick="loadAsync('getcurrent.html?prev',updateCurrent)">
						<img src="images/prev.gif" width="24" height="24" border="0" alt="jump to previous song">
					</a>
				</td>
				<td>
					<a href="javascript:void(0)" onclick="loadAsync('getcurrent.html?play',updateCurrent)">
						<img src="images/play.gif" width="24" height="24" border="0" alt="start playback">
					</a>
				</td>
				<td>
					<a href="javascript:void(0)" onclick="loadAsync('getcurrent.html?stop',updateCurrent)">
						<img src="images/stop.gif" width="24" height="24" border="0" alt="stop playback">
					</a>
				</td>
				<td>
					<a href="javascript:void(0)" onclick="loadAsync('getcurrent.html?pause',updateCurrent)">
						<img src="images/pause.gif" width="24" height="24" border="0" alt="pause playback">
					</a>
				</td>
				<td>
					<a href="javascript:void(0)" onclick="loadAsync('getcurrent.html?next',updateCurrent)">
						<img src="images/next.gif" width="24" height="24" border="0" alt="jump to next song">
					</a>
				</td>
			</tr>
		</table>
		
        <ul>
			<li><a href="javascript:void(0)" id="currentAlbum">Album: <img src="images/loading.gif" width="20" /></a></li>
			<li id="currentArtist">Artist: <img src="images/loading.gif" width="20" /></li>
			<li id="currentTitle">Title: <img src="images/loading.gif" width="20" /></li>
			<li id="currentInfo">Info: <img src="images/loading.gif" width="20" /></li>
		</ul>
		<img id="currentAlbumArt" src="images/loading.gif" width="100" />
    </div>
    
    <div id="test" class="panel" title="Belle & Sebastian">
		<h2>Normal list</h2>
		<ul>
			<li>About</li>
			<li>Blog</li>
		</ul>
		<h2>Link List:</h2>
		<ul>
			<li><a href="#consulting-clinic.html">Consulting Clinic</a></li>
			<li><a href="#on-call.html">On Call</a></li>
			<li><a href="#development.html">Development</a></li>
		</ul>
		<h2>About</h2>
		<p>Jonathan Stark is a web developer, speaker, and author. His 
		   consulting firm, Jonathan Stark Consulting, Inc., has attracted
		   clients such as Staples, Turner Broadcasting, and the PGA Tour.
		   ...
		</p>
		<p>Jonathan Stark is a mobile and web application developer who the
		   Wall Street Journal has called an expert on publishing desktop 
		   data to the web.</p>
		<ul>
			<li><a href="#services.html">Services</a></li>
			<li><a href="#about.html">About</a></li>
			<li><a href="#blog.html">Blog</a></li>
		</ul>
    </div>
    
    <div id="options" class="panel" title="Options">		
        <ul>
			<li>dsfg</li>
			<li>sdfars</li>
			<li>ds ase rtg fg</li>
			<li>araw</li>
		</ul>
	</div>    
    
    <ul id="CrowdedHouse" title="Crowded House">
        <li><a href="#songs">Crowded House</a></li>
        <li><a href="#songs">Temple of Low Men</a></li>
        <li><a href="#songs">Together Alone</a></li>
        <li><a href="#songs">Woodface</a></li>
    </ul>
    <ul id="JohnMayer" title="John Mayer">
        <li><a href="#songs">Continuum</a></li>
        <li><a href="#songs">Heavier Things</a></li>
        <li><a href="#songs">Room for Squares</a></li>
    </ul>
    <ul id="Zero7" title="Zero 7">
        <li><a href="#songs">The Garden</a></li>
        <li><a href="#songs">Simple Things</a></li>
        <li><a href="#songs">When it Falls</a></li>
    </ul>
    <ul id="songs" title="Songs">
        <li><a href="#player">Song 1</a></li>
        <li><a href="#player">Song 2</a></li>
        <li><a href="#player">Song 3</a></li>
        <li><a href="#player">Song 4</a></li>
        <li><a href="#player">Song 5</a></li>
        <li><a href="#player">Song 6</a></li>
        <li><a href="#player">Song 7</a></li>
        <li><a href="#player">Song 8</a></li>
        <li><a href="#player">Song 9</a></li>
        <li><a href="#player">Song 10</a></li>
        <li><a href="#player">Song 11</a></li>
    </ul>
    <div id="player" class="panel" title="Now Playing">
        <p>asdf</p>
    </div>
    <div id="searchResults" class="panel" title="Search" onfocus="getSearchResults(this)">
		<h2>asdf</h2>
    </div>
    <form id="searchForm" class="dialog" action="#searchResults">
        <fieldset>
            <h1>Music Search</h1>
            <a class="button toolButton goButton" href="#searchResults">Search</a>
            
            <label>Artist:</label>
            <input type="text" name="artist" />
            <label>Song:</label>
            <input type="text" name="song" />
        </fieldset>
    </form>
</body>
</html>
